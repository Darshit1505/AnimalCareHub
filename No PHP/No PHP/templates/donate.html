{% extends "base.html" %}
{% set page_active = 'donate' %}
{% block body_class %}donate-page form-page{% endblock %}

{% block title %}Support Our Mission - Donate to Pet's Paalan{% endblock %}

{% block head %}
    {{ super() }}
    <style>
        /* Optional minor tweaks for donate page */
        .donate-image {
            object-fit: cover;
            height: 100%;
            max-height: 500px; /* Limit image height */
        }
        .form-container.card {
             border: none; /* Remove border if using shadow */
        }
    </style>
{% endblock %}


{% block content %}
<div class="container py-5">
    <div class="row justify-content-center align-items-center g-lg-5">

        {# Column 1: Image and Text #}
        <div class="col-lg-5 text-center text-lg-start mb-5 mb-lg-0">
            <h1 class="display-5 fw-bold lh-1 mb-3 text-success"><i class="fas fa-hand-holding-heart me-2"></i>Your Kindness Makes a Difference</h1>
            <p class="lead text-muted mb-4">
                Every contribution helps us provide essential care, medical treatment, food, shelter,
                and find loving homes for animals in need. Choose to donate funds or essential supplies today.
            </p>
             {# *** REPLACE IMAGE PATH *** #}
            <img src="{{ url_for('static', filename='image/donate-group1.jpg') }}" alt="Group of happy rescued animals" class="img-fluid rounded shadow-lg donate-image">
        </div>

        {# Column 2: Donation Form #}
        <div class="col-lg-7 col-xl-6">
            <div class="form-container-wrapper">
                <div class="form-container card shadow-sm">
                     <div class="card-body p-4 p-lg-5"> {# More padding #}
                        <h2 class="h4 mb-4 text-center">Make a Donation</h2>
                         {# Flash messages handled in base.html, appear above content #}

                        <form id="donation-form" method="POST" action="{{ url_for('donate_page') }}">
                            {# Basic Info #}
                            <div class="row mb-3">
                                <div class="col-md-6"> <label for="donor-name" class="form-label">Full Name</label> <input type="text" class="form-control form-control-sm" id="donor-name" name="donor_name" value="{{ form_data.get('donor_name', '') }}" required> </div>
                                <div class="col-md-6"> <label for="donor-email" class="form-label">Email Address</label> <input type="email" class="form-control form-control-sm" id="donor-email" name="donor_email" value="{{ form_data.get('donor_email', '') }}" required> </div>
                            </div>
                            <div class="mb-3"> <label for="donor-phone" class="form-label">Phone <small class="text-muted">(Optional)</small></label> <input type="tel" class="form-control form-control-sm" id="donor-phone" name="donor_phone" value="{{ form_data.get('donor_phone', '') }}"> </div>

                            {# Donation Type #}
                            <div class="mb-3"> <label for="donation-type" class="form-label">Donation Type</label> <select class="form-select form-select-sm" id="donation-type" name="donation_type" onchange="handleDonationTypeChange()" required> <option value="" disabled {% if not form_data.get('donation_type') %}selected{% endif %}>-- Select Type --</option> <option value="Money" {% if form_data.get('donation_type') == 'Money' %}selected{% endif %}>Money</option> <option value="Products" {% if form_data.get('donation_type') == 'Products' %}selected{% endif %}>Products</option> </select> </div>

                            {# Conditional Fields #}
                            <div id="money-donation-fields" style="display: none;">
                                <hr class="my-3">
                                <div class="row mb-3">
                                    <div class="col-md-6"> <label for="amount" class="form-label">Amount (â‚¹)</label> <input type="number" class="form-control form-control-sm" id="amount" name="amount" placeholder="0.00" min="1" step="any" value="{{ form_data.get('amount', '') }}"> </div>
                                    <div class="col-md-6"> <label for="payment-method" class="form-label">Method</label> <select class="form-select form-select-sm" id="payment-method" name="payment_method"> <option value="" disabled selected>-- Select --</option> <option value="Credit Card">Credit Card</option> <option value="Bank Transfer">Bank Transfer</option> <option value="UPI">UPI</option> <option value="PayPal">PayPal</option> </select> </div>
                                </div>
                                {# Add placeholder for actual payment integration here #}
                                <p class="small text-muted text-center">Note: Secure payment processing will be handled on the next step (integration required).</p>
                            </div>
                            <div id="product-donation-fields" style="display: none;">
                                 <hr class="my-3">
                                <div class="mb-3"> <label for="product-details" class="form-label">Product Details</label> <textarea class="form-control form-control-sm" id="product-details" name="product_details" placeholder="e.g., 5kg dog food, blankets, toys" rows="3">{{ form_data.get('product_details', '') }}</textarea> <div class="form-text small">We appreciate your generosity! Please contact us after submitting to arrange drop-off or collection.</div> </div>
                            </div>
                            {# End Conditional Fields #}

                            <button type="submit" class="btn btn-success w-100 mt-4">Complete Donation</button>
                        </form>
                    </div>
                </div>
             </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
    {{ super() }}
    {# JS to toggle donation fields #}
    <script>
        function handleDonationTypeChange() {
            const donationType = document.getElementById('donation-type').value;
            const moneyFields = document.getElementById('money-donation-fields');
            const productFields = document.getElementById('product-donation-fields');
            const amountInput = document.getElementById('amount');
            const paymentMethodSelect = document.getElementById('payment-method');
            const productDetailsTextarea = document.getElementById('product-details');
            // Hide sections first
            if(moneyFields) moneyFields.style.display = 'none';
            if(productFields) productFields.style.display = 'none';
            // Remove required attributes
            if (amountInput) amountInput.required = false; if (paymentMethodSelect) paymentMethodSelect.required = false; if (productDetailsTextarea) productDetailsTextarea.required = false;
            // Show relevant section and set required
            if (donationType === 'Money') { if(moneyFields) moneyFields.style.display = 'block'; if (amountInput) amountInput.required = true; if (paymentMethodSelect) paymentMethodSelect.required = true; }
            else if (donationType === 'Products') { if(productFields) productFields.style.display = 'block'; if (productDetailsTextarea) productDetailsTextarea.required = true; }
        }
        document.addEventListener('DOMContentLoaded', handleDonationTypeChange); // Run on load
    </script>
{% endblock %}